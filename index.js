import{i as l,S as O,a as P,R as _,A as x}from"./assets/vendor-BkXgttEf.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();const v=document.querySelector(".order-modal"),f=document.querySelector(".order-form"),R=document.querySelector(".order-close");let C="";v&&!v.classList.contains("hidden")&&(C=document.title,document.title="Замовити зворотний зв’язок.",document.body.style.overflow="hidden");R.addEventListener("click",()=>L());v.addEventListener("click",e=>{e.target===v&&L()});document.addEventListener("keydown",e=>{e.key==="Escape"&&L()});function L(){v.classList.add("hidden"),document.title=C,document.body.style.overflow="","selectedFurnitureId"in localStorage&&localStorage.removeItem("selectedFurnitureId"),"selectedFurnitureColor"in localStorage&&localStorage.removeItem("selectedFurnitureColor")}f.addEventListener("submit",async e=>{e.preventDefault();const t=f.elements.name,s=f.elements.phone,o=f.elements.comment;let r=!0;if([t,s,o].forEach(n=>{n.classList.remove("error"),n.value.trim()||(n.classList.add("error"),r=!1)}),!/^\+?\d{10,15}$/.test(s.value.trim())){s.classList.add("error"),l.error({title:"Помилка",message:"Введіть правильний номер телефону у форматі +380XXXXXXXXX",position:"center",timeout:3e3});return}const c=o.value.trim();if(!/^[a-zA-Zа-яА-ЯїЇіІєЄґҐ0-9\s.,!?'"()\-:;]{5,300}$/u.test(c)){o.classList.add("error"),l.error({title:"Помилка",message:"Коментар має містити від 5 до 300 символів і не містити заборонених знаків.",position:"center",timeout:3e3});return}if(!r){l.error({title:"Помилка",message:"Заповніть усі обовʼязкові поля!",position:"center",timeout:3e3});return}const i={name:t.value.trim(),phone:s.value.trim(),modelId:localStorage.getItem("selectedFurnitureId")||"682f9bbf8acbdf505592ac36",color:localStorage.getItem("selectedFurnitureColor")||"#1212ca",comment:c};try{const n=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!n.ok){const u=await n.json();l.error({title:"Помилка сервера",message:u.message||"Не вдалося зробити замовлення.",position:"center",timeout:3e3});return}l.success({title:"Успішно!",message:"Вашу заявку відправлено.",position:"center",timeout:3e3}),f.reset(),L()}catch(n){l.error({title:"Помилка",message:n.message||"Не вдалося відправити заявку",position:"topRight"})}});const B=document.querySelector(".modal-wrapper");async function z(e){const t=`https://furniture-store-v2.b.goit.study/api/furnitures/${e}`;try{return(await axios.get(t)).data}catch(s){return iziToast.error({position:"topRight",message:`Помилка завантаження деталей товару: ${s.message}`}),null}}function H(){document.querySelectorAll(".details-button").forEach(t=>{t.addEventListener("click",async s=>{const o=s.target.dataset.id,r=await z(o);r&&X(r)})})}function X(e){const t=`
        <div class="modal-backdrop" id="productModal">
            <div class="modal-content" data-product-id="${e._id}">
                <button class="close-button" id="closeModalButton">&times;</button>
                <div class="product-details">
                    <div class="image-column">
                        <div class="main-image-container">
                            <img src="${e.images[0]}" alt="${e.name}" class="main-image" id="modalMainImage">
                        </div>
                        <div class="additional-images">
                            ${e.images[1]?`<div class="image-thumb"><img src="${e.images[1]}" alt="Додаткове зображення 1" class="thumb-image"></div>`:""}
                            ${e.images[2]?`<div class="image-thumb"><img src="${e.images[2]}" alt="Додаткове зображення 2" class="thumb-image"></div>`:""}
                        </div>
                    </div>
                    <div class="product-info-column">
                        <h1 class="product-title">${e.name}</h1>
                        <p class="product-category">${e.type}</p>
                        <p class="product-price">${e.price} грн</p>
                        <div class="product-rating">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                        <div class="color-options">
                            <p class="color-label">Колір</p>
                            <div class="color-swatches" id="modalColorOptions">
                                ${e.color.slice(0,3).map((o,r)=>`<div 
                                        class="color-swatch ${r===0?"selected":""}" 
                                        data-color-id="${e._id}-${r}" 
                                        data-img-index="${r}"
                                        style="background-color: ${o};"
                                    ></div>`).join("")}
                            </div>
                        </div>
                        <p class="product-description">${e.description||"Класичний диван з м'якими подушками та високою спинкою, ідеальний для сімейного відпочинку. Оббивка з якісної зносостійкої тканини."}</p>
                        <p class="product-size"><span class="size-label">Розміри:</span> ${e.dimensions||"280х80х85"}</p>
                        <button class="order-button" id="submitOrderButton">Перейти до замовлення</button>
                    </div>
                </div>
            </div>
        </div>
    `;B.innerHTML=t;const s=document.getElementById("productModal");s.style.display="flex",document.body.style.overflow="hidden",j(e)}function j(e){const t=document.getElementById("productModal");if(!t)return;const s=t.querySelector("#closeModalButton"),o=t.querySelectorAll(".color-swatch"),r=t.querySelector("#modalMainImage"),a=t.querySelector("#submitOrderButton"),c=()=>{t.style.display="none",document.body.style.overflow="auto",B.innerHTML=""};s.addEventListener("click",c),t.addEventListener("click",i=>{i.target===t&&c()});let p=t.querySelector(".color-swatch.selected"),d=p?p.style.backgroundColor:null;const M=i=>{if(!i||typeof i!="string")return i;const n=i.trim();if(n.startsWith("#"))return n.toLowerCase();const u=n.match(/(\d+(\.\d+)?%?)/g);if(!u||u.length<3)return n;const $=g=>g.endsWith("%")?Math.round(parseFloat(g)/100*255):Math.round(parseFloat(g)),T=$(u[0]),F=$(u[1]),A=$(u[2]),S=g=>g.toString(16).padStart(2,"0");return`#${S(T)}${S(F)}${S(A)}`.toLowerCase()};o.forEach(i=>{i.addEventListener("click",()=>{t.querySelector(".color-swatch.selected").classList.remove("selected"),i.classList.add("selected");const n=parseInt(i.dataset.imgIndex);e.images[n]&&(r.src=e.images[n]),d=i.style.backgroundColor})}),a.addEventListener("click",()=>{try{if(!d&&p&&(d=getComputedStyle(p).backgroundColor),!d){iziToast.warning({position:"topRight",message:"Будь ласка, оберіть колір перед продовженням!"});return}let i=d.startsWith("#")?d.toLowerCase():M(d);localStorage.setItem("selectedFurnitureId",e._id),localStorage.setItem("selectedFurnitureColor",i),c();const n=document.querySelector(".order-modal");n?(n.classList.remove("hidden"),document.body.style.overflow="hidden"):(console.error("Елемент '.order-modal' не знайдено."),iziToast.warning({position:"topRight",message:"Форма замовлення недоступна. Дані збережено."}))}catch(i){console.error("Несподівана помилка в обробнику submit:",i),iziToast.error({position:"topRight",message:"Виникла помилка при оформленні замовлення."})}})}let m=1,b=0,w=8,h="",E=document.querySelector(".our-furniture .furniture-items"),D=document.querySelector(".our-furniture .options");const y=document.querySelector(".our-furniture .show-more");D.addEventListener("click",async e=>{const t=e.target.closest(".option");if(!t)return;document.querySelectorAll(".our-furniture .options .option").forEach(r=>r.classList.remove("active")),t.classList.add("active"),h=t.dataset.category,m=1;const s=await I(h,m),o=s.furnitures;E.innerHTML="",q(o),b=Math.ceil(s.totalItems/w),y.style.display=m<b?"block":"none"});y.addEventListener("click",async()=>{y.classList.add("active"),m++;const t=(await I(h,m)).furnitures;q(t),y.classList.remove("active"),y.style.display=m<b?"block":"none"});window.addEventListener("DOMContentLoaded",async()=>{let e=document.querySelector(".our-furniture .options .option:first-child");e.classList.add("active"),h=e.dataset.category;let t=await I(h,m),s=t.furnitures;E.innerHTML="",q(s),b=Math.ceil(t.totalItems/w)});async function I(e,t){const s=e==="All furniture"?`https://furniture-store-v2.b.goit.study/api/furnitures?page=${t}&limit=${w}`:`https://furniture-store-v2.b.goit.study/api/furnitures?category=${e}&page=${t}&limit=${w}`;try{return(await axios.get(s)).data}catch(o){return l.info({position:"topRight",message:o.message}),{furnitures:[],totalItems:0}}}function q(e){let t=e.map(o=>`<li class="item" data-id="${o._id}">
        <div class="item-image-container">
            <img src="${o.images[0]}"/>
        </div>
            <p class="item-name">${o.name}</p>
            <div class="color-options">
                <button class="color" type="button" data-color = "${o.color[0]}" data-img="${o.images[0]}"></button>
                <button class="color" type="button" data-color = "${o.color[1]}" data-img="${o.images[1]}"></button>
                <button class="color" type="button" data-color = "${o.color[2]}" data-img="${o.images[2]}"></button>
            </div>

            <p class="item-price"><span>${o.price}</span> грн</p>
            <button class="details-button" data-id="${o._id}">Детальніше</button>
        
        </li>`).join("");E.insertAdjacentHTML("beforeend",t),document.querySelectorAll(".our-furniture .furniture-items .item .color-options .color").forEach(o=>{o.style.backgroundColor=o.dataset.color}),N(),H()}function N(){document.querySelectorAll(".color-options .color").forEach(t=>{t.addEventListener("click",()=>{const s=t.dataset.img,r=t.closest(".item").querySelector(".item-image-container img");r.src=s})})}async function V(){try{return(await P.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{page:1,limit:10}})).data.feedbacks}catch(e){l.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedbacks:",e)}}async function W(e){const t=document.querySelector(".review-carousel"),s=e.map(o=>`<li class="review-item swiper-slide">
  <div class="stars-rating" data-score="${o.rate}"></div>
  <p class="review-item-text">"${o.descr}"</p>
  <p class="review-item-name">${o.name}</p>
</li>`).join("");t.querySelector(".review .swiper-wrapper").insertAdjacentHTML("beforeend",s),document.querySelectorAll(".stars-rating").forEach(o=>{const r=parseFloat(o.dataset.score);new _(o,{round:{down:.25,full:.75,up:.76},readOnly:!0,score:r,starType:"i"}).init()})}const G=document.querySelector(".review-carousel"),J=new O(G,{slidesPerView:1,spaceBetween:16,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3}},pagination:{el:".review .swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{prevEl:".review .nav-btn-prev",nextEl:".review .nav-btn-next"}});async function K(){try{const e=await V();W(e),J.update()}catch(e){l.error({title:"Помилка",message:"Не вдалося завантажити галерею відгуків. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedback:",e)}finally{}}K();function Q(){if(document.querySelector(".accordion-container"))try{new x(".accordion-container",{duration:400,showMultiple:!1,collapse:!0,onOpen:t=>{},onClose:t=>{}})}catch{}}document.addEventListener("DOMContentLoaded",Q);const k=document.querySelector(".footer-logo");k&&k.addEventListener("click",e=>{e.preventDefault();const t=window.location.pathname.split("/"),s=t[1]?`/${t[1]}/`:"/";window.location.href=window.location.origin+s});
//# sourceMappingURL=index.js.map
